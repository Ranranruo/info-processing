CREATE TABLE TBL_MEMBER_202005 (
	M_NO CHAR(1) PRIMARY KEY,
	V_NAME VARCHAR2(20),
	P_CODE CHAR(2),
	V_TIME CHAR(1),
	V_AREA CHAR(13),
	V_CONFIRM VARCHAR2(20)
);

INSERT INTO TBL_MEMBER_202005 VALUES ('1', '김후보', 'P1', '1', '6603011999991', '수선화동');
INSERT INTO TBL_MEMBER_202005 VALUES ('2', '이후보', 'P2', '3', '5503011999992', '민들래동');
INSERT INTO TBL_MEMBER_202005 VALUES ('3', '박후보', 'P3', '2', '7703011999993', '나팔꽃동');
INSERT INTO TBL_MEMBER_202005 VALUES ('4', '조후보', 'P4', '2', '8803011999994', '진달래동');
INSERT INTO TBL_MEMBER_202005 VALUES ('5', '최후보', 'P5', '3', '9903011999995', '개나리동');


CREATE TABLE TBL_PARTY_202005 (
	P_CODE CHAR(2) PRIMARY KEY,
	P_NAME VARCHAR2(20),
	P_INDATE DATE,
	P_READER VARCHAR2(20),
	P_TEL1 CHAR(3),
	P_TEL2 CHAR(4),
	P_TEL3 CHAR(4)
);
INSERT INTO TBL_PARTY_202005 VALUES ('P1', 'A정당', '2010-01-01', '위대표', '02', '1111', '0001');
INSERT INTO TBL_PARTY_202005 VALUES ('P2', 'B정당', '2010-02-01', '명대표', '02', '1111', '0002');
INSERT INTO TBL_PARTY_202005 VALUES ('P3', 'C정당', '2010-03-01', '기대표', '02', '1111', '0003');
INSERT INTO TBL_PARTY_202005 VALUES ('P4', 'D정당', '2010-04-01', '옥대표', '02', '1111', '0004');
INSERT INTO TBL_PARTY_202005 VALUES ('P5', 'E정당', '2010-05-01', '임대표', '02', '1111', '0005');


CREATE TABLE TBL_VOTE_202005 (
V_JUMIN CHAR(13) PRIMARY KEY,
V_NAME VARCHAR2(20),
M_NO CHAR(1),
V_TIME CHAR(4),
V_AREA CHAR(20),
V_CONFIRM CHAR(1)
);

INSERT INTO TBL_VOTE_202005 VALUES ('9001011000001', '김유권', '1', '0930', '제1투표장','N');
INSERT INTO TBL_VOTE_202005 VALUES ('8901012000002', '이유권', '2', '0930', '제1투표장','N');
INSERT INTO TBL_VOTE_202005 VALUES ('6901011000003', '박유권', '3', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('5901012000004', '홍유권', '4', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000005', '조유권', '5', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('8901012000006', '최유권', '1', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('5901011000007', '지유권', '1', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('4901012000008', '장유권', '3', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000009', '정유권', '3', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('8901012000010', '강유권', '4', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('9901011000011', '신유권', '5', '0930', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000012', '오유권', '1', '1330', '제1투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('6901011000013', '현유권', '4', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('8901011000014', '왕유권', '2', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('9901011000015', '유유권', '3', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000016', '한유권', '2', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('8901011000017', '문유권', '4', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('9901011000018', '양유권', '2', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('9901011000019', '구유권', '4', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000020', '황유권', '5', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('6901011000021', '배유권', '3', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('7901011000022', '전유권', '3', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('9901011000023', '고유권', '1', '1330', '제2투표장','Y');
INSERT INTO TBL_VOTE_202005 VALUES ('5901011000024', '권유건', '3', '1330', '제2투표장','Y');


SELECT * FROM TBL_MEMBER_202005 m, TBL_PARTY_202005 p WHERE m.P_CODE = p.P_CODE;

SELECT v.V_NAME, '19'||substr(v.V_JUMIN, 0, 2)||'월'||substr(v.V_JUMIN, 3, 2)||'월'||substr(v.V_JUMIN, 5, 2)||'일생', '만 '||TRUNC(MONTHS_BETWEEN(TRUNC(SYSDATE), TO_DATE('19'||substr(v.V_JUMIN, 0, 6),'YYYYMMDD')) / 12)||'세', CASE WHEN substr(v.V_JUMIN, 7, 1) = '2' THEN '여' WHEN substr(v.V_JUMIN, 7, 1) = '1' THEN '남' END, m.V_NAME, substr(v.V_TIME, 0, 2)||':'||substr(v.V_TIME, 3, 2), CASE WHEN v.V_CONFIRM = 'Y' THEN '확인' WHEN v.V_CONFIRM = 'N' THEN '미확인' END, v.V_AREA FROM TBL_MEMBER_202005 m, TBL_VOTE_202005 v WHERE m.M_NO = v.M_NO AND v.V_AREA = '제1투표장'
SELECT v.V_NO, m.V_NAME